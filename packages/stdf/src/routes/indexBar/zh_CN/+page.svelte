<!-- IndexBar Demo -->
<script lang="ts">
	import { IndexBar, ButtonGroup, Toast, Icon } from '$lib/index.js';
	import type { IndexBarItemProps } from '$lib/types/index.js';

	const addressList: IndexBarItemProps[] = [
		{ index: 'A', title: 'A', child: ['æ¾³é—¨', 'å®‰å®', 'å®‰åº†', 'éå±±'] },
		{ index: 'B', title: 'B', child: ['åŒ—äº¬', 'ä¿å®š', 'åŒ…å¤´', 'å®é¸¡'] },
		{ index: 'C', title: 'C', child: ['æ‰¿å¾·', 'æ²§å·', 'èµ¤å³°'] },
		{ index: 'D', title: 'D', child: ['å¤§åŒ', 'å¤§è¿', 'å¤§ç†'] },
		{ index: 'E', title: 'E', child: ['æ©æ–½', 'é„‚å°”å¤šæ–¯', 'å³¨çœ‰å±±'] },
		{ index: 'F', title: 'F', child: ['æŠšé¡º', 'ä½›å±±', 'ç¦æ³‰'] },
		{ index: 'G', title: 'G', child: ['ä¸ªæ—§', 'æ¡‚æ—', 'èµ£å·'] },
		{ index: 'H', title: 'H', child: ['é‚¯éƒ¸', 'å‘¼å’Œæµ©ç‰¹', 'å‘¼ä¼¦è´å°”'] },
		{ index: 'J', title: 'J', child: ['å‰æ—', 'é…’æ³‰', 'æ™‹æ±Ÿ'] },
		{ index: 'K', title: 'K', child: ['æ˜†æ˜', 'æ˜†å±±', 'å¼€å°'] },
		{ index: 'L', title: 'L', child: ['æ‹‰è¨', 'å…°å·', 'æ³¸å·'] },
		{ index: 'M', title: 'M', child: ['ç»µé˜³', 'é©¬éå±±', 'ç‰¡ä¸¹æ±Ÿ'] },
		{ index: 'N', title: 'N', child: ['å—æ˜Œ', 'å—äº¬', 'å®æ³¢'] },
		{ index: 'P', title: 'P', child: ['è†ç”°', 'æ”€æèŠ±', 'å¹³é¡¶å±±'] },
		{ index: 'Q', title: 'Q', child: ['æ›²é–', 'é’å²›', 'é½é½å“ˆå°”'] },
		{ index: 'R', title: 'R', child: ['ç‘ä¸½', 'ç‘å®‰', 'ç‘é‡‘'] },
		{ index: 'S', title: 'S', child: ['ä¸‰äºš', 'ä¸Šæµ·', 'æ·±åœ³'] },
		{ index: 'T', title: 'T', child: ['å°å·', 'å¤ªåŸ', 'å¤©æ´¥'] },
		{ index: 'W', title: 'W', child: ['æ­¦æ±‰', 'æ— é”¡', 'èŠœæ¹–'] },
		{ index: 'X', title: 'X', child: ['è¥¿å®‰', 'å¦é—¨', 'å®£å¨'] },
		{ index: 'Y', title: 'Y', child: ['ä¹‰ä¹Œ', 'é“¶å·', 'ç‰æºª'] },
		{ index: 'Z', title: 'Z', child: ['æ˜­é€š', 'éµä¹‰', 'å¼ å®¶ç•Œ'] }
	];
	const emojiList: IndexBarItemProps[] = [
		{ index: 'ğŸ˜€', title: 'è¡¨æƒ…ä¸æƒ…æ„Ÿ', child: ['ğŸ˜‚', 'ğŸ¥°', 'ğŸ¥±', 'ğŸ§'] },
		{ index: 'ğŸ‘‹', title: 'äººç‰©ä¸èº«ä½“', child: ['ğŸ‘Œ', 'ğŸ¤', 'ğŸ‘¨â€ğŸ’»', 'ğŸ’ª'] },
		{ index: 'ğŸµ', title: 'åŠ¨ç‰©ä¸è‡ªç„¶', child: ['ğŸ¦„', 'ğŸŒ±', 'ğŸ¦', 'ğŸ¶'] },
		{ index: 'ğŸ', title: 'é£Ÿç‰©ä¸é¥®æ–™', child: ['ğŸ‘', 'ğŸ', 'ğŸ½ï¸', 'ğŸ©'] },
		{ index: 'ğŸŒ', title: 'æ—…è¡Œä¸åœ°ç†', child: ['ğŸ”ï¸', 'ğŸš†', 'âœˆï¸', 'ğŸ›µ'] },
		{ index: 'ğŸ†', title: 'æ´»åŠ¨', child: ['âš½', 'ğŸ¨', 'ğŸ€', 'ğŸ§¨'] },
		{ index: 'ğŸ“±', title: 'ç‰©å“', child: ['ğŸ©', 'ğŸ’»', 'ğŸ’', 'ğŸ“–'] },
		{ index: 'âš ï¸', title: 'ç¬¦å·æ ‡å¿—', child: ['ğŸš«', 'âš›ï¸', 'ğŸ›„', 'ğŸ”±'] },
		{ index: 'ğŸ', title: 'æ——å¸œ', child: ['ğŸ‡¨ğŸ‡³', 'ğŸ‡ºğŸ‡¸', 'ğŸ‡§ğŸ‡»', 'ğŸ‡¦ğŸ‡¹'] }
	];

	// å¤æ‚æ•°æ®ç»“æ„ï¼šè”ç³»äºº
	type ContactItem = {
		name: string;
		phone: string;
	};
	const contactList: IndexBarItemProps<ContactItem>[] = [
		{
			index: 'A',
			title: 'A',
			child: [
				{ name: 'é˜¿é‡Œ', phone: '138****1234' },
				{ name: 'å®‰è¿ª', phone: '139****5678' },
				{ name: 'è‰¾ç±³', phone: '137****9012' }
			]
		},
		{
			index: 'B',
			title: 'B',
			child: [
				{ name: 'è´è´', phone: '136****3456' },
				{ name: 'åšæ–‡', phone: '135****7890' }
			]
		},
		{
			index: 'C',
			title: 'C',
			child: [
				{ name: 'é™ˆæ™¨', phone: '134****1234' },
				{ name: 'ç¨‹ç¨‹', phone: '133****5678' },
				{ name: 'èªèª', phone: '132****9012' }
			]
		},
		{
			index: 'D',
			title: 'D',
			child: [
				{ name: 'ä¸¹ä¸¹', phone: '131****3456' },
				{ name: 'ä¸œä¸œ', phone: '130****7890' }
			]
		},
		{
			index: 'L',
			title: 'L',
			child: [
				{ name: 'ææ˜', phone: '158****1234' },
				{ name: 'åˆ˜æ´‹', phone: '159****5678' },
				{ name: 'æ—æ¶›', phone: '157****9012' }
			]
		},
		{
			index: 'W',
			title: 'W',
			child: [
				{ name: 'ç‹èŠ³', phone: '186****3456' },
				{ name: 'å´åˆš', phone: '187****7890' },
				{ name: 'é­æ˜', phone: '188****1234' }
			]
		},
		{
			index: 'Z',
			title: 'Z',
			child: [
				{ name: 'å¼ ä¼Ÿ', phone: '198****5678' },
				{ name: 'èµµæ•', phone: '199****9012' },
				{ name: 'å‘¨æ°', phone: '197****3456' }
			]
		}
	];

	// é¢œè‰²åˆ—è¡¨ï¼Œé€šè¿‡ Snippet åŠ¨æ€é€‰æ‹©
	const colors = [
		'bg-red-500',
		'bg-orange-500',
		'bg-amber-500',
		'bg-yellow-500',
		'bg-lime-500',
		'bg-green-500',
		'bg-emerald-500',
		'bg-teal-500',
		'bg-cyan-500',
		'bg-sky-500',
		'bg-blue-500',
		'bg-indigo-500',
		'bg-violet-500',
		'bg-purple-500',
		'bg-fuchsia-500',
		'bg-pink-500',
		'bg-rose-500'
	];

	const navHeight = 48;
	const bottomHeight = 50;
	const height = window.innerHeight - navHeight - bottomHeight;
	let radius: 'sm' | 'full' | 'none' = $state('sm');
	let dataFlag = $state(2);
	let scrollAlign = $state(true);
	let injClassList: string[] = $state([]);
	let snippetStyle = $state(0); // è”ç³»äºº Snippet æ ·å¼ï¼š0-å¤´åƒå¡ç‰‡ã€1-ç®€çº¦åˆ—è¡¨ã€2-å½©è‰²æ ‡ç­¾
	const changeRadiusFun = () => {
		radius = radius === 'sm' ? 'full' : radius === 'full' ? 'none' : 'sm';
	};
	const changeListFun = () => {
		dataFlag = dataFlag === 0 ? 1 : dataFlag === 1 ? 2 : 0;
		snippetStyle = 0; // åˆ‡æ¢æ•°æ®æ—¶é‡ç½®æ ·å¼
	};
	const changeScrollAlignFun = () => {
		scrollAlign = !scrollAlign;
	};
	const changeStyleFun = () => {
		if (dataFlag === 2) {
			// è”ç³»äººæ¨¡å¼ï¼šåˆ‡æ¢ Snippet æ ·å¼
			snippetStyle = (snippetStyle + 1) % 3;
		} else {
			// å…¶ä»–æ¨¡å¼ï¼šåˆ‡æ¢æ³¨å…¥æ ·å¼
			injClassList = !injClassList.length ? ['!text-3xl text-center', 'text-xs text-center !py-1'] : [];
		}
	};
	let visible = $state(false);
	let toastMessage = $state('');
</script>

{#if dataFlag === 0}
	<IndexBar
		data={addressList}
		{radius}
		{height}
		{scrollAlign}
		titleInjClass={injClassList[0]}
		textInjClass={injClassList[1]}
		top={navHeight}
		onclickChild={(index, group, childIndex, child) => {
			toastMessage = `ç‚¹å‡»äº†ç¬¬ ${index + 1} ç»„ï¼ˆ${group.title}ï¼‰ä¸­çš„ç¬¬ ${childIndex + 1} é¡¹ï¼ˆ${child}ï¼‰`;
			visible = true;
		}}
	/>
{:else if dataFlag === 1}
	<IndexBar
		data={emojiList}
		{radius}
		{height}
		{scrollAlign}
		titleInjClass={injClassList[0]}
		textInjClass={injClassList[1]}
		top={navHeight}
		onclickChild={(index, group, childIndex, child) => {
			toastMessage = `ç‚¹å‡»äº†ç¬¬ ${index + 1} ç»„ï¼ˆ${group.title}ï¼‰ä¸­çš„ç¬¬ ${childIndex + 1} é¡¹ï¼ˆ${child}ï¼‰`;
			visible = true;
		}}
	/>
{:else}
	<IndexBar
		data={contactList}
		{radius}
		{height}
		{scrollAlign}
		top={navHeight}
		onclickChild={(index, group, childIndex, child) => {
			toastMessage = `ç‚¹å‡»äº† ${child.name}ï¼Œç”µè¯ï¼š${child.phone}`;
			visible = true;
		}}
	>
		{#snippet children(item, childIndex, group, groupIndex)}
			{#if snippetStyle === 0}
				<!-- å¤´åƒå¡ç‰‡æ ·å¼ -->
				<div class="flex items-center gap-3 py-1">
					<div class="{colors[(groupIndex * 3 + childIndex) % colors.length]} flex h-10 w-10 items-center justify-center rounded-full text-lg font-medium text-white">
						{item.name[0]}
					</div>
					<div class="flex-1">
						<div class="font-medium">{item.name}</div>
						<div class="text-xs text-black/50 dark:text-white/50">{item.phone}</div>
					</div>
					<Icon name="ri-phone-line" />
				</div>
			{:else if snippetStyle === 1}
				<!-- ç®€çº¦åˆ—è¡¨æ ·å¼ -->
				<div class="flex items-center justify-between py-2">
					<span class="font-medium">{item.name}</span>
					<span class="text-sm text-black/60 dark:text-white/60">{item.phone}</span>
				</div>
			{:else}
				<!-- å½©è‰²æ ‡ç­¾æ ·å¼ -->
				<div class="flex items-center gap-2 py-1">
					<span class="{colors[(groupIndex * 3 + childIndex) % colors.length]} rounded-md px-2 py-1 text-sm text-white">{item.name}</span>
					<span class="text-xs text-black/50 dark:text-white/50">{item.phone}</span>
				</div>
			{/if}
		{/snippet}
	</IndexBar>
{/if}
<Toast bind:visible message={toastMessage} />

<div class="sticky bottom-0 z-10 bg-white/90 dark:bg-black/90">
	<ButtonGroup
		fill="lineState"
		items={[
			{ text: dataFlag === 0 ? 'åŸå¸‚' : dataFlag === 1 ? 'è¡¨æƒ…' : 'è”ç³»äºº', onclick: changeListFun },
			{ text: scrollAlign ? 'å¯¹é½å…³é—­' : 'å¯¹é½å¼€å¯', onclick: changeScrollAlignFun },
			{ text: 'åœ†è§’', onclick: changeRadiusFun },
			{ text: dataFlag === 2 ? (snippetStyle === 0 ? 'å¡ç‰‡' : snippetStyle === 1 ? 'åˆ—è¡¨' : 'æ ‡ç­¾') : 'æ ·å¼', onclick: changeStyleFun }
		]}
	/>
</div>
